define(['text!templates/shipToSelector.html'],function(template){Vue.component('shipto',{template:template,data:function(){return{sharedState:bwb.store.state};},computed:{selectedFlagIconClass:function(){if(this.sharedState.country=="--"){this.flagSelect(this.sharedState.siteId==1?"us":"gb");}
return 'flag-icon-'+this.sharedState.country;}},methods:{flagSelect:function(newValue){var rate=bwb.serverShare.pricing.getCurrentCurrencyExchangeRateByCurrencyCode(this.sharedState.cartCurrency);bwb.localize.relocalize(rate);bwb.user.setShipToCountry(newValue);},setLocalCurrency:function(){var self=this;bwb.user.setLocalCurrency(this.sharedState.cartCurrency,function(){self.sharedState.useLocalCurrency=(self.sharedState.cartCurrency!='USD');});var rate=bwb.serverShare.pricing.getCurrentCurrencyExchangeRateByCurrencyCode(this.sharedState.cartCurrency);bwb.localize.relocalize(rate);$('#shipToSelector').dropdown('toggle');},getLocalCurrency:function(countryCode){console.log('getLocalCurrency called with ',countryCode);return bwb.serverShare.pricing.getCurrentCurrencyExchangeRate(countryCode).Currency;},findCurrencyExchangeRate:function(countryCode){return bwb.serverShare.pricing.getCurrentCurrencyExchangeRate(countryCode);}},mounted:function(){$("#shipToSelector").click(function(){var input=$("#shipToSelectorInput");setTimeout(function(){input.val("");input.focus();input.keyup(function(){$("#shipToContainer").scrollTo($("a[name='ctry_"+$(this).val()+"']"));input.val("");});},1);});this.flagSelect(this.sharedState.country);}});});