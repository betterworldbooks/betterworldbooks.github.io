define(['text!templates/searchBox.html'],function(template){Vue.component('searchbox',{template:template,props:['app-id','api-key','qs-api-key','qs-index-name','index-name','enable-autocomplete'],data:function(){return{placeholder:'Search by Title, Author, or ISBN',sharedState:bwb.store.state,index:null};},methods:{setQuery:function(){this.sharedState.searchQuery=bwb.helpers.cleanupSearchQuery(this.sharedState.searchQuery);bwb.store.setQuery(this.sharedState.searchQuery);document.title='Browse our online store | Better World Books';$('meta[name="description"]').attr("content",'Shop our inventory for new and used books with fast free shipping on every used book we have in stock!');$('meta[name="keywords"]').attr("content",'used, new, discounted, used books, free shipping, cheap books, secondhand, thrift');if(this.sharedState.searchQuery.length)
bwb.store.setSearchVisible(true);},clearQuery:function(reFocus){this.sharedState.searchQuery='';this.setQuery();if(reFocus)
$('.nav-search-box').focus();},handleSearchEvent:function(event){event.preventDefault();this.setQuery();}},mounted:function(){var self=this;self.sharedState.searchQuery=self.sharedState.searchStore.query;if(self.sharedState.searchStore){self.sharedState.searchQuery=self.sharedState.searchStore.query;}else{self.sharedState.searchQuery='';}
if(self.enableAutocomplete){var client=algoliasearch(self.appId,self.qsApiKey);self.index=client.initIndex(self.qsIndexName);autocomplete('.nav-search-box',{hint:false},[{source:autocomplete.sources.hits(self.index,{hitsPerPage:10}),displayKey:'Title',templates:{suggestion:function(suggestion){return '<div class="autocomplete-suggestion">'+suggestion._highlightResult.query.value+'</div>';}}}]).on('autocomplete:selected',function(event,suggestion){self.sharedState.searchQuery=suggestion.query;self.setQuery();});$('.nav-search-box').on('blur',function(event){if(!self.sharedState.searchQuery.length){$(event.target).val('');self.clearQuery();}else{$(event.target).val(self.sharedState.searchQuery);}});}}});});